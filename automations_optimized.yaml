- id: '1654632188370'
  alias: Window opening in the morning living room
  description: 'Esta automação controla: window opening in the morning living room.'
  triggers:
  - event: sunrise
    offset: 0
    trigger: sun
  conditions:
  - condition: state
    entity_id: input_boolean.visits_on_disable_light_automation
    state: 'off'
  - condition: state
    state: 'off'
    entity_id: input_boolean.longer_visits
    enabled: false
  actions:
  - if:
    - condition: and
      conditions:
      - condition: state
        entity_id: sensor.season
        state: summer
      - condition: numeric_state
        entity_id: weather.pedroucos
        attribute: temperature
        above: 19
      - condition: state
        entity_id: weather.pedroucos
        state: sunny
    then:
    - device_id: c44fa21082233a06cf61d554ee67c0ed
      domain: cover
      entity_id: 63a395517b2d945b32e43907016829e1
      type: set_position
      position: 20
    - device_id: 4284d6153210243e2991fd76018ababc
      domain: cover
      entity_id: 91188817a7ef1c3e6a0f41855b9792f3
      type: set_position
      position: 69
    else:
    - device_id: 4284d6153210243e2991fd76018ababc
      domain: cover
      entity_id: 91188817a7ef1c3e6a0f41855b9792f3
      type: set_position
      position: 69
    - device_id: c44fa21082233a06cf61d554ee67c0ed
      domain: cover
      entity_id: 63a395517b2d945b32e43907016829e1
      type: open
  mode: single
- id: '1654632422008'
  alias: Windows closing at 23:30
  description: 'Esta automação controla: windows closing at 23:30.'
  trigger:
  - platform: time
    at: '23:30:00'
  condition: []
  action:
  - choose:
    - conditions:
      - condition: not
        conditions:
        - condition: state
          entity_id: sensor.season
          state: summer
      sequence:
      - device_id: 5c1e4ccb3754b0dbe99b65a69e77325b
        domain: cover
        entity_id: cover.bedroom_window
        type: set_position
        position: 0
      - device_id: c44fa21082233a06cf61d554ee67c0ed
        domain: cover
        entity_id: 63a395517b2d945b32e43907016829e1
        type: close
      - device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
        domain: cover
        entity_id: cover.shellyswitch25_c45bbe5fbbe6
        type: set_position
        position: 0
      - device_id: 4284d6153210243e2991fd76018ababc
        domain: cover
        entity_id: 91188817a7ef1c3e6a0f41855b9792f3
        type: close
    - conditions:
      - condition: state
        entity_id: sensor.season
        state: summer
      sequence:
      - device_id: 5c1e4ccb3754b0dbe99b65a69e77325b
        domain: cover
        entity_id: cover.bedroom_window
        type: set_position
        position: 15
      - device_id: c44fa21082233a06cf61d554ee67c0ed
        domain: cover
        entity_id: 63a395517b2d945b32e43907016829e1
        type: set_position
        position: 16
      - device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
        domain: cover
        entity_id: cover.shellyswitch25_c45bbe5fbbe6
        type: set_position
        position: 15
      - device_id: 4284d6153210243e2991fd76018ababc
        domain: cover
        entity_id: 91188817a7ef1c3e6a0f41855b9792f3
        type: set_position
        position: 65
  mode: single
- id: '1654632591867'
  alias: Windows closing at sun's down
  description: 'Esta automação controla: windows closing at sun''s down.'
  triggers:
  - event: sunset
    offset: 00:30
    trigger: sun
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: not
        conditions:
        - condition: state
          entity_id: sensor.season
          state: summer
      sequence:
      - device_id: 5c1e4ccb3754b0dbe99b65a69e77325b
        domain: cover
        entity_id: cover.bedroom_window
        type: set_position
        position: 0
      - device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
        domain: cover
        entity_id: cover.shellyswitch25_c45bbe5fbbe6
        type: set_position
        position: 0
      - device_id: 4284d6153210243e2991fd76018ababc
        domain: cover
        entity_id: 91188817a7ef1c3e6a0f41855b9792f3
        type: close
    - conditions:
      - condition: state
        entity_id: sensor.season
        state: summer
      - condition: numeric_state
        entity_id: sensor.temperatura_do_quarto_temperatura
        above: 23
      sequence:
      - device_id: 5c1e4ccb3754b0dbe99b65a69e77325b
        domain: cover
        entity_id: cover.bedroom_window
        type: set_position
        position: 15
      - device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
        domain: cover
        entity_id: cover.shellyswitch25_c45bbe5fbbe6
        type: set_position
        position: 15
      - device_id: 4284d6153210243e2991fd76018ababc
        domain: cover
        entity_id: 91188817a7ef1c3e6a0f41855b9792f3
        type: set_position
        position: 65
  mode: single
- id: '1654633444923'
  alias: Timeout for bed light
  description: 'Esta automação controla: timeout for bed light.'
  trigger:
  - platform: device
    type: turned_on
    device_id: 455d92c6ea382ca723ac5c052c67a148
    entity_id: light.bed_light
    domain: light
    for:
      hours: 1
      minutes: 0
      seconds: 0
  condition: []
  action:
  - type: turn_off
    device_id: 455d92c6ea382ca723ac5c052c67a148
    entity_id: light.bed_light
    domain: light
  mode: single
- id: '1654639773215'
  alias: When in garage zone open outside door
  description: 'Esta automação controla: when in garage zone open outside door.'
  triggers:
  - entity_id: person.tiago_alves
    zone: zone.casa_2
    event: enter
    trigger: zone
  conditions: []
  actions:
  - action: notify.mobile_app_onenotenord4
    data:
      message: Abrindo a porta da garagem exterior!
  - target:
      entity_id: scene.porta_da_garagem_subir
    metadata: {}
    action: scene.turn_on
    data: {}
  mode: single
- id: '1654640468272'
  alias: Turn on tv in the morning
  description: 'Esta automação controla: turn on tv in the morning.'
  trigger:
  - platform: sun
    event: sunrise
    offset: 0
  condition: []
  action:
  - type: turn_on
    device_id: af42c5910582557714970ad2254285e4
    entity_id: switch.living_room_extension_usb_1
    domain: switch
  - type: turn_on
    device_id: af42c5910582557714970ad2254285e4
    entity_id: 8f33213edd2ed42d76b8791a7ffa0756
    domain: switch
  mode: single
- id: '1654641873945'
  alias: Temperature is low
  description: 'Esta automação controla: temperature is low.'
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.sensores_de_temperatura_minimo
    below: 18
  conditions:
  - condition: or
    conditions:
    - condition: zone
      entity_id: person.camila_oliveira
      zone: zone.casa_2
    - condition: zone
      entity_id: person.tiago_alves
      zone: zone.casa_2
    - condition: time
      after: 00:00:00
      before: 06:00:00
      weekday:
      - sat
      - fri
      - thu
      - wed
      - tue
      - mon
      - sun
  - condition: state
    entity_id: binary_sensor.janelas_casa
    state: 'off'
  - condition: state
    entity_id: input_boolean.caldeira_ligada
    state: 'off'
  - condition: state
    entity_id: input_boolean.ausencia_prolongada
    state: 'off'
  actions:
  - type: turn_on
    device_id: f6496fb848e55b0eeeb40b780a6a7ad3
    entity_id: switch.baxi
    domain: switch
  mode: single
- id: '1654892303488'
  alias: Close forgotten opened garage door
  description: 'Esta automação controla: close forgotten opened garage door.'
  triggers:
  - type: powered
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: binary_sensor.garage_door_external_input
    domain: binary_sensor
    for:
      minutes: 5
    trigger: device
  - type: powered
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: binary_sensor.garage_door_external_input
    domain: binary_sensor
    for:
      minutes: 20
    trigger: device
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: sensor.onenotenord4_wi_fi_connection
      state: Buraquinho de Marmelada
    - condition: state
      entity_id: sensor.iphone_ssid
      state: Buraquinho de Marmelada
    - condition: state
      entity_id: input_boolean.garagem_aberta_forcar
      state: 'on'
  actions:
  - data:
      message: A porta da garagem está aberta há algum tempo. Queres fechá-la?
      data:
        actions:
        - action: CLOSE_GARAGE
          title: Fechar Porta
    action: notify.mobile_app_onenotenord4
  - wait_for_trigger:
    - event_type: mobile_app_notification_action
      event_data:
        action: CLOSE_GARAGE
      trigger: event
    timeout: 00:05:00
    continue_on_timeout: true
  - choose:
    - conditions:
      - condition: template
        value_template: '{{ wait.trigger is not none }}'
      sequence:
      - target:
          device_id: 5c202b6459996e960257949ef048b3e8
        action: switch.turn_on
        data: {}
    default:
    - data:
        message: A porta da garagem continua aberta. Última oportunidade para fechá-la
          manualmente.
        data:
          actions:
          - action: CLOSE_GARAGE
            title: Fechar Agora
      action: notify.mobile_app_onenotenord4
    - wait_for_trigger:
      - event_type: mobile_app_notification_action
        event_data:
          action: CLOSE_GARAGE
        trigger: event
      timeout: 00:02:00
      continue_on_timeout: true
    - target:
        device_id: 5c202b6459996e960257949ef048b3e8
      action: switch.turn_on
      data: {}
  mode: single
- id: '1655399152396'
  alias: Close forgotten opened garage door
  description: 'Esta automação controla: close forgotten opened garage door.'
  triggers:
  - type: powered
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: binary_sensor.garage_door_external_input
    domain: binary_sensor
    for:
      minutes: 5
    trigger: device
  - type: powered
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: binary_sensor.garage_door_external_input
    domain: binary_sensor
    for:
      minutes: 20
    trigger: device
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: sensor.onenotenord4_wi_fi_connection
      state: Buraquinho de Marmelada
    - condition: state
      entity_id: sensor.iphone_ssid
      state: Buraquinho de Marmelada
    - condition: state
      entity_id: input_boolean.garagem_aberta_forcar
      state: 'on'
  actions:
  - data:
      message: A porta da garagem está aberta há algum tempo. Queres fechá-la?
      data:
        actions:
        - action: CLOSE_GARAGE
          title: Fechar Porta
        - action: IGNORE
          title: Ignorar
    action: notify.mobile_app_onenotenord4
  - wait_for_trigger:
    - event_type: mobile_app_notification_action
      event_data:
        action: CLOSE_GARAGE
      trigger: event
    - event_type: mobile_app_notification_action
      event_data:
        action: IGNORE
      trigger: event
    timeout: 00:05:00
    continue_on_timeout: true
  - choose:
    - conditions:
      - condition: template
        value_template: '{{ wait.trigger.event.data.action == ''CLOSE_GARAGE'' }}'
      sequence:
      - target:
          device_id: 5c202b6459996e960257949ef048b3e8
        action: switch.turn_on
        data: {}
    default:
    - data:
        message: A porta da garagem continua aberta. Última oportunidade para fechá-la
          manualmente.
        data:
          actions:
          - action: CLOSE_GARAGE
            title: Fechar Agora
          - action: IGNORE
            title: Ignorar
      action: notify.mobile_app_onenotenord4
    - wait_for_trigger:
      - event_type: mobile_app_notification_action
        event_data:
          action: CLOSE_GARAGE
        trigger: event
      - event_type: mobile_app_notification_action
        event_data:
          action: IGNORE
        trigger: event
      timeout: 00:02:00
      continue_on_timeout: true
    - choose:
      - conditions:
        - condition: template
          value_template: '{{ wait.trigger.event.data.action == ''CLOSE_GARAGE'' }}'
        sequence:
        - target:
            device_id: 5c202b6459996e960257949ef048b3e8
          action: switch.turn_on
          data: {}
  mode: single
- id: '1655514860512'
  alias: Connects to buraquinho de marmelada
  description: 'Esta automação controla: connects to buraquinho de marmelada.'
  triggers:
  - entity_id:
    - sensor.onenotenord4_wi_fi_connection
    for:
      hours: 0
      minutes: 0
      seconds: 5
    id: wifi_connected
    to: Buraquinho de Marmelada
    trigger: state
  - entity_id:
    - sensor.iphone_ssid
    for:
      hours: 0
      minutes: 0
      seconds: 5
    to: Buraquinho de Marmelada
    id: wifi_connected_camila
    trigger: state
  conditions:
  - condition: template
    value_template: '{{ (now()|as_timestamp - state_attr(''automation.disconnect_from_buraquinho_de_marmelada'',
      ''last_triggered'')|as_timestamp) > 30 }}'
  - type: is_not_powered
    condition: device
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: binary_sensor.garage_door_external_input
    domain: binary_sensor
  actions:
  - type: turn_on
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: switch.garage_door
    domain: switch
  - data:
      message: A porta da garagem está a abrir!
      title: Porta da garagem
    enabled: false
    action: notify.notify
  - delay:
      hours: 0
      minutes: 2
      seconds: 0
      milliseconds: 0
  mode: single
- id: '1655544759801'
  alias: Disconnect from buraquinho de marmelada
  description: 'Esta automação controla: disconnect from buraquinho de marmelada.'
  triggers:
  - entity_id:
    - sensor.onenotenord4_wi_fi_connection
    for:
      hours: 0
      minutes: 0
      seconds: 10
    from: Buraquinho de Marmelada
    id: wifi_disconnected
    trigger: state
  - entity_id:
    - sensor.iphone_ssid
    for:
      hours: 0
      minutes: 0
      seconds: 10
    from: Buraquinho de Marmelada
    id: wifi_disconnected_camila
    trigger: state
  conditions:
  - condition: template
    value_template: '{{ (now()|as_timestamp - state_attr(''automation.connects_to_buraquinho_de_marmelada'',''last_triggered'')|as_timestamp)
      > 30 }}'
  - type: is_powered
    condition: device
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: binary_sensor.garage_door_external_input
    domain: binary_sensor
  - condition: not
    conditions:
    - condition: state
      entity_id: sensor.onenotenord4_wi_fi_connection
      state: Buraquinho de Marmelada
    - condition: state
      entity_id: sensor.iphone_ssid
      state: Buraquinho de Marmelada
    - condition: template
      value_template: "{{ '41:42:88:00:02:42 (CAR-XTD-BT_F71E)' in state_attr('sensor.iphone_bssid')\
        \ \n}}"
      enabled: false
    - condition: template
      value_template: "{{ '41:42:88:00:02:42 (CAR-XTD-BT_F71E)' in state_attr('sensor.onenotenord4_bluetooth_connection','connected_paired_devices')\
        \ \n}}"
    - condition: state
      entity_id: binary_sensor.onenotenord4_android_auto
      state: 'on'
    - condition: state
      entity_id: sensor.iphone_bssid
      state: ''
    - condition: state
      entity_id: input_boolean.garagem_aberta_forcar
      state: 'on'
  actions:
  - type: turn_on
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: switch.garage_door
    domain: switch
  - delay:
      hours: 0
      minutes: 2
      seconds: 0
      milliseconds: 0
  mode: single
- id: '1656360757652'
  alias: When in garage zone open outside door (camila)
  description: 'Esta automação controla: when in garage zone open outside door (camila).'
  triggers:
  - entity_id: person.camila_oliveira
    zone: zone.casa_2
    event: enter
    trigger: zone
  conditions: []
  actions:
  - action: notify.mobile_app_iphone
    data:
      message: 'Bem-vinda a casa, Camila! '
  - target:
      entity_id: scene.porta_da_garagem_subir
    metadata: {}
    action: scene.turn_on
    data: {}
  mode: single
- id: '1656889917366'
  alias: A etiqueta quarto é lida
  description: 'Esta automação controla: a etiqueta quarto é lida.'
  trigger:
  - platform: tag
    tag_id: 36e95748-a956-4868-a283-d033b5814015
  condition: []
  action:
  - target:
      entity_id: scene.desligar_quarto
    metadata: {}
    action: scene.turn_on
  - target:
      entity_id: scene.desligar_corredor
    metadata: {}
    action: scene.turn_on
  - target:
      entity_id: scene.desligar_casa_de_banho
    metadata: {}
    action: scene.turn_on
  - target:
      entity_id: scene.desligar_cozinha
    metadata: {}
    action: scene.turn_on
  - target:
      entity_id: scene.desligar_sala
    metadata: {}
    action: scene.turn_on
  - target:
      entity_id: scene.desligar_casa_de_banho_do_corredor
    metadata: {}
    action: scene.turn_on
  - metadata: {}
    target:
      entity_id: scene.desligar_quarto_da_madalena
    action: scene.turn_on
  - wait_for_trigger:
    - platform: tag
      tag_id: 36e95748-a956-4868-a283-d033b5814015
    timeout:
      hours: 0
      minutes: 1
      seconds: 0
      milliseconds: 0
    continue_on_timeout: false
  - device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
    domain: cover
    entity_id: 646ddfcbd3a3188708a8c8c6c9b383dd
    type: close
  - device_id: 5c1e4ccb3754b0dbe99b65a69e77325b
    domain: cover
    entity_id: 09fd91dd262c372506de662ecddf7bb9
    type: close
  mode: single
- id: '1657452185055'
  alias: Warn about forgotten opened garage door (1h)
  description: 'Esta automação controla: warn about forgotten opened garage door (1h).'
  triggers:
  - type: powered
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: binary_sensor.garage_door_external_input
    domain: binary_sensor
    for:
      hours: 1
      minutes: 0
      seconds: 0
    trigger: device
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: sensor.onenotenord4_wi_fi_connection
      state: Buraquinho de Marmelada
    - condition: state
      entity_id: sensor.iphone_ssid
      state: Buraquinho de Marmelada
    - condition: state
      entity_id: input_boolean.garagem_aberta_forcar
      state: 'on'
  actions:
  - data:
      data:
        actions:
        - action: CLOSE_GARAGE
          title: Fechar garagem
        - action: LEAVE_OPEN
          title: Deixar aberta
      title: Garagem aberta por mais de 1h!
      message: O que pretende fazer?
    action: notify.mobile_app_onenotenord4
  - wait_for_trigger:
    - event_type: mobile_app_notification_action
      event_data:
        action: CLOSE_GARAGE
      trigger: event
    timeout: 00:30:00
    continue_on_timeout: false
  - type: turn_on
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: switch.garage_door
    domain: switch
    enabled: true
  mode: single
- id: '1657453442488'
  alias: Erro no fecho da porta
  description: 'Esta automação controla: erro no fecho da porta.'
  trigger:
  - platform: device
    type: turned_on
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: switch.garage_door
    domain: switch
  condition:
  - type: is_powered
    condition: device
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: binary_sensor.garage_door_external_input
    domain: binary_sensor
  action:
  - delay:
      hours: 0
      minutes: 0
      seconds: 30
      milliseconds: 0
  - if:
    - type: is_powered
      condition: device
      device_id: 5c202b6459996e960257949ef048b3e8
      entity_id: binary_sensor.garage_door_external_input
      domain: binary_sensor
    then:
    - service: notify.notify
      data:
        message: Verifique o estado da mesma.
        title: Erro no fecho de porta da garagem!
  mode: single
- id: '1659569965169'
  alias: Abrir garagem (notificação)
  description: 'Esta automação controla: abrir garagem (notificação).'
  trigger:
  - type: powered
    platform: device
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: binary_sensor.garage_door_external_input
    domain: binary_sensor
  condition:
  - condition: state
    entity_id: input_boolean.garage_closed
    state: 'on'
  action:
  - service: notify.notify
    data:
      message: A Porta da Garagem abriu!
      title: Porta da garagem
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.garage_closed
  mode: single
- id: '1659570012109'
  alias: Fechar garagem (notificação)
  description: 'Esta automação controla: fechar garagem (notificação).'
  trigger:
  - type: not_powered
    platform: device
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: binary_sensor.garage_door_external_input
    domain: binary_sensor
  condition:
  - condition: state
    entity_id: input_boolean.garage_closed
    state: 'off'
  action:
  - service: notify.notify
    data:
      message: A Porta da Garagem fechou!
      title: Porta da garagem
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.garage_closed
  mode: single
- id: '1666220235097'
  alias: Temperature is high
  description: 'Esta automação controla: temperature is high.'
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.sensores_de_temperatura_minimo
    above: 19.99
  conditions:
  - condition: state
    entity_id: switch.baxi
    state: 'on'
  - condition: state
    entity_id: input_boolean.caldeira_ligada
    state: 'on'
  actions:
  - type: turn_off
    device_id: f6496fb848e55b0eeeb40b780a6a7ad3
    entity_id: switch.baxi
    domain: switch
  mode: single
- id: '1666443797953'
  alias: Sair de casa
  description: 'Esta automação controla: sair de casa.'
  triggers:
  - entity_id: person.camila_oliveira
    zone: zone.aproximacao_casa
    event: leave
    trigger: zone
  - entity_id: person.tiago_alves
    zone: zone.aproximacao_casa
    event: leave
    trigger: zone
  conditions:
  - type: is_no_motion
    condition: device
    device_id: 421990f9314c17597d7f3789ada40a83
    entity_id: binary_sensor.contact_sensor_b0b4_motion_detected
    domain: binary_sensor
    for:
      hours: 0
      minutes: 0
      seconds: 0
  - condition: not
    conditions:
    - condition: zone
      entity_id: person.camila_oliveira
      zone: zone.casa_2
    - condition: zone
      entity_id: person.tiago_alves
      zone: zone.casa_2
  - type: is_not_open
    condition: device
    device_id: 421990f9314c17597d7f3789ada40a83
    entity_id: binary_sensor.contact_sensor_b0b4_door_open
    domain: binary_sensor
  - condition: state
    entity_id: input_boolean.visits_on_disable_light_automation
    state: 'off'
  - condition: state
    entity_id: input_boolean.longer_visits
    state: 'off'
  - type: is_no_motion
    condition: device
    device_id: afc69c02c34df8cefa4d5e214b06bfec
    entity_id: binary_sensor.motion_sensor_657b_motion_detected
    domain: binary_sensor
  actions:
  - target:
      entity_id: scene.desligar_quarto
    metadata: {}
    action: scene.turn_on
    data: {}
  - target:
      entity_id: scene.desligar_corredor
    metadata: {}
    action: scene.turn_on
    data: {}
  - target:
      entity_id: scene.desligar_casa_de_banho
    metadata: {}
    action: scene.turn_on
    data: {}
  - target:
      entity_id: scene.desligar_cozinha
    metadata: {}
    action: scene.turn_on
    data: {}
  - target:
      entity_id: scene.desligar_sala
    metadata: {}
    action: scene.turn_on
    data: {}
  - target:
      entity_id: scene.desligar_casa_de_banho_do_corredor
    metadata: {}
    action: scene.turn_on
    data: {}
  - action: vacuum.start
    metadata: {}
    data: {}
    target:
      entity_id: vacuum.roborock_s8_pro_ultra
  - data: {}
    target:
      entity_id: alarm_control_panel.alexa_guard_d128e
    action: alarm_control_panel.alarm_arm_away
  - if:
    - condition: time
      after: '10:00:00'
      before: '20:00:00'
    then:
    - data:
        media_content_type: routine
        media_content_id: Routine to turn on vacuum cleaner
      target:
        entity_id: media_player.kitchen_s_echo
      action: media_player.play_media
    enabled: false
  - data:
      media_content_id: stop
      media_content_type: custom
    target:
      entity_id:
      - media_player.kitchen_s_echo
      - media_player.echo_dot_de_tiago
      - media_player.bedroom_echo
      - media_player.madalena_s_echo
    action: media_player.play_media
  mode: single
- id: '1667047560794'
  alias: Ligar luzes da cozinha
  description: 'Esta automação controla: ligar luzes da cozinha.'
  triggers:
  - type: motion
    device_id: afc69c02c34df8cefa4d5e214b06bfec
    entity_id: binary_sensor.motion_sensor_657b_motion_detected
    domain: binary_sensor
    trigger: device
  - type: motion
    device_id: 421990f9314c17597d7f3789ada40a83
    entity_id: binary_sensor.contact_sensor_b0b4_motion_detected
    domain: binary_sensor
    trigger: device
  - type: turned_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: light.kitchen_lights_channel_1
    domain: light
    trigger: device
  - type: turned_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: switch.kitchen_lights_channel_2
    domain: switch
    enabled: true
    trigger: device
  conditions:
  - condition: device
    type: is_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: light.kitchen_lights_channel_1
    domain: light
  - condition: device
    type: is_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: switch.kitchen_lights_channel_2
    domain: switch
  - condition: or
    conditions:
    - condition: sun
      after: sunset
      before: sunrise
    - condition: time
      after: '21:00:00'
      before: 06:00:00
      weekday:
      - mon
      - wed
      - tue
      - thu
      - fri
      - sat
      - sun
      enabled: false
  - condition: or
    conditions:
    - type: is_motion
      condition: device
      device_id: afc69c02c34df8cefa4d5e214b06bfec
      entity_id: binary_sensor.motion_sensor_657b_motion_detected
      domain: binary_sensor
    - type: is_motion
      condition: device
      device_id: 421990f9314c17597d7f3789ada40a83
      entity_id: binary_sensor.contact_sensor_b0b4_motion_detected
      domain: binary_sensor
  - condition: state
    entity_id: light.kitchen_up_light
    state: 'off'
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      brightness_pct: 45
      kelvin: 2973
    target:
      entity_id: light.kitchen_up_light
  - data:
      media_content_type: routine
      media_content_id: Routine to turn on tapo
    target:
      entity_id: media_player.kitchen_s_echo
    enabled: false
    action: media_player.play_media
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.luz_do_balcao_ligar
  - delay:
      hours: 0
      minutes: 0
      seconds: 10
      milliseconds: 0
  mode: single
- id: '1667049465955'
  alias: Desligar luzes da cozinha
  description: 'Esta automação controla: desligar luzes da cozinha.'
  triggers:
  - type: no_motion
    device_id: afc69c02c34df8cefa4d5e214b06bfec
    entity_id: binary_sensor.motion_sensor_657b_motion_detected
    domain: binary_sensor
    for:
      hours: 0
      minutes: 10
      seconds: 0
    trigger: device
  conditions:
  - condition: sun
    after: sunset
  - condition: time
    after: '16:30:00'
    before: 00:00:00
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
    - sun
  - condition: state
    entity_id: input_boolean.visits_on_disable_light_automation
    state: 'off'
  - condition: state
    entity_id: input_boolean.longer_visits
    state: 'off'
  actions:
  - type: turn_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: light.kitchen_lights_channel_1
    domain: light
  - type: turn_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: switch.kitchen_lights_channel_2
    domain: switch
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.luz_do_balcao_desligar
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.kitchen_up_light
  mode: single
- id: '1667049712420'
  alias: Desligar luzes da cozinha se ligar luz principal
  description: 'Esta automação controla: desligar luzes da cozinha se ligar luz principal.'
  triggers:
  - type: turned_on
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: light.kitchen_lights_channel_1
    domain: light
    trigger: device
  - type: turned_on
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: switch.kitchen_lights_channel_2
    domain: switch
    trigger: device
  conditions:
  - condition: sun
    after: sunset
    enabled: false
  - condition: or
    conditions:
    - condition: sun
      after: sunrise
    - condition: time
      after: '21:00:00'
      before: 08:00:00
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      - sat
      - sun
  actions:
  - delay:
      hours: 0
      minutes: 0
      seconds: 3
      milliseconds: 0
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.kitchen_up_light
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.luz_do_balcao_desligar
  mode: single
- id: '1667050721441'
  alias: Desligar as luzes da cozinha durante o dia
  description: 'Esta automação controla: desligar as luzes da cozinha durante o dia.'
  trigger:
  - type: no_motion
    platform: device
    device_id: afc69c02c34df8cefa4d5e214b06bfec
    entity_id: binary_sensor.motion_sensor_657b_motion_detected
    domain: binary_sensor
    for:
      hours: 0
      minutes: 10
      seconds: 0
  condition:
  - condition: or
    conditions:
    - condition: sun
      after: sunrise
    - condition: time
      before: '18:00:00'
      weekday:
      - mon
      - tue
      - thu
      - wed
      - fri
      - sat
      - sun
      after: 08:00:00
  - condition: state
    entity_id: input_boolean.visits_on_disable_light_automation
    state: 'off'
  - condition: state
    entity_id: input_boolean.longer_visits
    state: 'off'
  action:
  - type: turn_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: light.kitchen_lights_channel_1
    domain: light
  - type: turn_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: switch.kitchen_lights_channel_2
    domain: switch
  mode: single
- id: '1667063022060'
  alias: Water boiling
  description: 'Esta automação controla: water boiling.'
  triggers:
  - type: temperature
    device_id: 106d6251964aa89970400e4154a1e8f7
    entity_id: sensor.smart_kettle_bbd7_temperature
    domain: sensor
    above: 99
    for:
      hours: 0
      minutes: 0
      seconds: 15
    trigger: device
  conditions:
  - condition: state
    entity_id: input_boolean.chaleira_reposta
    state: 'off'
  actions:
  - data:
      volume_level: 0.4
    target:
      device_id: b2a15ab03d14186eaefc6566fc16a85d
    action: media_player.volume_set
  - action: notify.alexa_media_kitchen_s_echo
    data:
      message: Your water is ready! Please take it when you're available!
  - action: script.notify_alexa
    metadata: {}
    data:
      devices:
      - b2a15ab03d14186eaefc6566fc16a85d
      message: Your water is ready! Please take it when you're available!
      title: Water is boiling
      type: announce
    enabled: false
  - data:
      volume_level: 0.3
    target:
      device_id: b2a15ab03d14186eaefc6566fc16a85d
    action: media_player.volume_set
  - wait_for_trigger: []
    timeout:
      hours: 0
      minutes: 2
      seconds: 0
      milliseconds: 0
  mode: single
- id: '1667177984848'
  alias: Desligar luzes da cozinha madrugada
  description: 'Esta automação controla: desligar luzes da cozinha madrugada.'
  triggers:
  - type: no_motion
    device_id: afc69c02c34df8cefa4d5e214b06bfec
    entity_id: binary_sensor.motion_sensor_657b_motion_detected
    domain: binary_sensor
    for:
      hours: 0
      minutes: 0
      seconds: 0
    trigger: device
  conditions:
  - condition: sun
    before: sunrise
  - condition: time
    after: 00:00:00
    before: 08:00:00
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
    - sun
  - condition: state
    entity_id: input_boolean.visits_on_disable_light_automation
    state: 'off'
  - condition: state
    entity_id: input_boolean.luzes_da_cozinha
    state: 'off'
  actions:
  - type: turn_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: light.kitchen_lights_channel_1
    domain: light
  - type: turn_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: switch.kitchen_lights_channel_2
    domain: switch
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.kitchen_up_light
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.luz_do_balcao_desligar
  mode: single
- id: '1667217701451'
  alias: A etiqueta cozinha é lida
  description: 'Esta automação controla: a etiqueta cozinha é lida.'
  trigger:
  - platform: tag
    tag_id: f39700f1-d949-4dc0-85bd-d2d15e8ab3f1
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: input_boolean.visits_on_disable_light_automation
        state: 'off'
      sequence:
      - service: input_boolean.turn_on
        data: {}
        target:
          entity_id: input_boolean.visits_on_disable_light_automation
      - service: ifttt.trigger
        data:
          event: deactivate_kitchen_light_automations
        enabled: false
      - service: media_player.volume_set
        data:
          volume_level: 0.4
        target:
          device_id: b2a15ab03d14186eaefc6566fc16a85d
      - service: notify.alexa_media_kitchen_s_echo
        data:
          message: 'Hello! I''m Alexa and I''m here to serve you! Welcome to Oliveira
            Alves family house! Despite kitchen light automations being made by my
            master Tiago, they are disabled now! Use the NFC tag again if you want
            to reactivate them. '
      - delay:
          hours: 0
          minutes: 0
          seconds: 3
          milliseconds: 0
      - service: media_player.volume_set
        data:
          volume_level: 0.3
        target:
          device_id: b2a15ab03d14186eaefc6566fc16a85d
    - conditions:
      - condition: state
        entity_id: input_boolean.visits_on_disable_light_automation
        state: 'on'
      sequence:
      - service: input_boolean.turn_off
        data: {}
        target:
          entity_id: input_boolean.visits_on_disable_light_automation
      - service: ifttt.trigger
        data:
          event: activate_kitchen_light_automations
        enabled: false
      - service: media_player.volume_set
        data:
          volume_level: 0.4
        target:
          device_id: b2a15ab03d14186eaefc6566fc16a85d
      - service: notify.alexa_media_kitchen_s_echo
        data:
          message: Your kitchen light automations are enabled again! Enjoy it! They
            will allow you to save some money on the energy bill. Thank you for saving
            the world, my master Tiago! You are the boss!
      - delay:
          hours: 0
          minutes: 0
          seconds: 3
          milliseconds: 0
      - service: media_player.volume_set
        data:
          volume_level: 0.3
        target:
          device_id: b2a15ab03d14186eaefc6566fc16a85d
  mode: single
- id: '1667350308659'
  alias: Chegar a casa
  description: 'Esta automação controla: chegar a casa.'
  trigger:
  - platform: zone
    entity_id: person.camila_oliveira
    zone: zone.aproximacao_casa
    event: enter
  - platform: zone
    entity_id: person.tiago_alves
    zone: zone.aproximacao_casa
    event: enter
  condition:
  - condition: not
    conditions:
    - condition: and
      conditions:
      - condition: zone
        entity_id: person.tiago_alves
        zone: zone.casa_2
      - condition: zone
        entity_id: person.camila_oliveira
        zone: zone.casa_2
  action:
  - type: turn_on
    device_id: af42c5910582557714970ad2254285e4
    entity_id: 8f33213edd2ed42d76b8791a7ffa0756
    domain: switch
  - type: turn_on
    device_id: af42c5910582557714970ad2254285e4
    entity_id: switch.living_room_extension_usb_1
    domain: switch
    enabled: true
  - data: {}
    target:
      entity_id: alarm_control_panel.alexa_guard_d128e
    action: alarm_control_panel.alarm_disarm
  - delay:
      hours: 0
      minutes: 30
      seconds: 0
      milliseconds: 0
    enabled: false
  - type: turn_on
    device_id: bb1e33d0865073ccbdeb5413b44ae020
    entity_id: dee24664505466a3f7a53b9116b08865
    domain: switch
  - metadata: {}
    data: {}
    target:
      entity_id: input_boolean.ausencia_prolongada
    action: input_boolean.turn_off
  - type: turn_on
    device_id: af42c5910582557714970ad2254285e4
    entity_id: 7c748e9ac09087608d00483732091318
    domain: switch
  - if:
    - condition: sun
      before: sunset
      after: sunrise
    then:
    - device_id: 4284d6153210243e2991fd76018ababc
      domain: cover
      entity_id: 91188817a7ef1c3e6a0f41855b9792f3
      type: set_position
      position: 70
    - device_id: c44fa21082233a06cf61d554ee67c0ed
      domain: cover
      entity_id: 63a395517b2d945b32e43907016829e1
      type: open
  mode: single
- id: '1668038018702'
  alias: Desligar luzes da cozinha (apenas led's ligados)
  description: 'Esta automação controla: desligar luzes da cozinha (apenas led''s
    ligados).'
  triggers:
  - type: no_motion
    device_id: afc69c02c34df8cefa4d5e214b06bfec
    entity_id: binary_sensor.motion_sensor_657b_motion_detected
    domain: binary_sensor
    for:
      hours: 0
      minutes: 0
      seconds: 0
    trigger: device
  conditions:
  - condition: sun
    after: sunset
  - condition: time
    after: '16:30:00'
    before: 00:00:00
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
    - sun
  - condition: state
    entity_id: input_boolean.visits_on_disable_light_automation
    state: 'off'
  - condition: device
    type: is_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: light.kitchen_lights_channel_1
    domain: light
  - condition: device
    type: is_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: switch.kitchen_lights_channel_2
    domain: switch
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.kitchen_up_light
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.luz_do_balcao_desligar
  mode: single
- id: '1672875549132'
  alias: Desligar luzes da cozinha (madrugada com visitas)
  description: 'Esta automação controla: desligar luzes da cozinha (madrugada com
    visitas).'
  triggers:
  - type: no_motion
    device_id: afc69c02c34df8cefa4d5e214b06bfec
    entity_id: binary_sensor.motion_sensor_657b_motion_detected
    domain: binary_sensor
    for:
      hours: 0
      minutes: 30
      seconds: 0
    trigger: device
  conditions:
  - condition: sun
    before: sunrise
  - condition: time
    after: 00:00:00
    before: 08:00:00
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
    - sun
  - condition: state
    entity_id: input_boolean.visits_on_disable_light_automation
    state: 'on'
  actions:
  - type: turn_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: light.kitchen_lights_channel_1
    domain: light
  - type: turn_off
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: switch.kitchen_lights_channel_2
    domain: switch
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.kitchen_up_light
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.luz_do_balcao_desligar
  mode: single
- id: '1675515402696'
  alias: Temperatura baixa (6:00)
  description: 'Esta automação controla: temperatura baixa (6:00).'
  triggers:
  - at: 06:01:00
    trigger: time
  conditions:
  - condition: state
    entity_id: input_boolean.ausencia_prolongada
    state: 'off'
  - condition: numeric_state
    entity_id: sensor.sensores_de_temperatura_minimo
    below: 18
  actions:
  - type: turn_on
    device_id: f6496fb848e55b0eeeb40b780a6a7ad3
    entity_id: switch.baxi
    domain: switch
  mode: single
- id: '1675641994386'
  alias: Bateria fraca (sensores)
  description: 'Esta automação controla: bateria fraca (sensores).'
  use_blueprint:
    path: sbyx/low-battery-level-detection-notification-for-all-battery-sensors.yaml
    input:
      threshold: 10
      actions:
      - data:
          message: 'Sem bateria nos seguintes sensores: {{sensors}}'
          title: Bateria fraca (sensores)
        action: notify.mobile_app_onenotenord4
      exclude:
        entity_id:
        - sensor.onenotenord4_battery_level
        - sensor.iphone_battery_level
  mode: single
- id: '1676724918082'
  alias: Temperatura normal (desligar baxi)
  description: 'Esta automação controla: temperatura normal (desligar baxi).'
  triggers:
  - type: turned_on
    device_id: f6496fb848e55b0eeeb40b780a6a7ad3
    entity_id: switch.baxi
    domain: switch
    for:
      hours: 1
      minutes: 0
      seconds: 0
    trigger: device
  conditions:
  - condition: numeric_state
    entity_id: sensor.sensores_de_temperatura_minimo
    above: 19.99
  actions:
  - type: turn_off
    device_id: f6496fb848e55b0eeeb40b780a6a7ad3
    entity_id: switch.baxi
    domain: switch
  mode: single
- id: '1679360324710'
  alias: Ativar/ desativar indicador luzes
  description: 'Esta automação controla: ativar/ desativar indicador luzes.'
  trigger:
  - platform: device
    type: changed_states
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: light.kitchen_lights_channel_1
    domain: light
  - platform: device
    type: changed_states
    device_id: e4830a18669837661bd3cf265ccc0213
    entity_id: d21666d9cc5dc30d21bfe1b47971468d
    domain: switch
  condition:
  - condition: time
    after: 00:00:00
    before: 08:00:00
    weekday:
    - sun
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
  action:
  - if:
    - condition: or
      conditions:
      - condition: device
        type: is_on
        device_id: e4830a18669837661bd3cf265ccc0213
        entity_id: light.kitchen_lights_channel_1
        domain: light
      - condition: device
        type: is_on
        device_id: e4830a18669837661bd3cf265ccc0213
        entity_id: d21666d9cc5dc30d21bfe1b47971468d
        domain: switch
    then:
    - data: {}
      target:
        entity_id: input_boolean.luzes_da_cozinha
      action: input_boolean.turn_on
    - delay:
        hours: 0
        minutes: 10
        seconds: 0
        milliseconds: 0
    - data: {}
      target:
        entity_id: input_boolean.luzes_da_cozinha
      action: input_boolean.turn_off
    - data:
        skip_condition: true
      target:
        entity_id: automation.desligar_luzes_da_cozinha_madrugada_com_visitas
      action: automation.trigger
  - if:
    - condition: and
      conditions:
      - condition: device
        type: is_off
        device_id: e4830a18669837661bd3cf265ccc0213
        entity_id: light.kitchen_lights_channel_1
        domain: light
      - condition: device
        type: is_off
        device_id: e4830a18669837661bd3cf265ccc0213
        entity_id: switch.kitchen_lights_channel_2
        domain: switch
    then:
    - data: {}
      target:
        entity_id: input_boolean.luzes_da_cozinha
      action: input_boolean.turn_off
  mode: single
- id: '1680951127049'
  alias: Ligar indicador de chaleira reposta
  description: 'Esta automação controla: ligar indicador de chaleira reposta.'
  trigger:
  - type: temperature
    platform: device
    device_id: 106d6251964aa89970400e4154a1e8f7
    entity_id: sensor.smart_kettle_bbd7_temperature
    domain: sensor
    below: 1
  condition:
  - condition: state
    entity_id: input_boolean.chaleira_reposta
    state: 'off'
  action:
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.chaleira_reposta
  mode: single
- id: '1680951169887'
  alias: Desligar indicador de chaleira reposta
  description: 'Esta automação controla: desligar indicador de chaleira reposta.'
  trigger:
  - type: temperature
    platform: device
    device_id: 106d6251964aa89970400e4154a1e8f7
    entity_id: sensor.smart_kettle_bbd7_temperature
    domain: sensor
    above: 1
    for:
      hours: 0
      minutes: 2
      seconds: 0
  condition:
  - condition: state
    entity_id: input_boolean.chaleira_reposta
    state: 'on'
  action:
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.chaleira_reposta
  mode: single
- id: '1684279332913'
  alias: Janelaa autom
  description: 'Esta automação controla: janelaa autom.'
  trigger:
  - platform: device
    type: turned_on
    device_id: 9e306f4c2ded510bf2bd63aa7312d89a
    entity_id: switch.madalena_light
    domain: switch
    alias: Janelas automática 2
  condition:
  - condition: sun
    after: sunrise
  - condition: device
    device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
    domain: cover
    entity_id: cover.shellyswitch25_c45bbe5fbbe6
    type: is_closed
  - condition: sun
    before: sunset
  - condition: time
    before: '20:45:00'
    weekday:
    - sat
    - fri
    - thu
    - wed
    - tue
    - mon
    - sun
  action:
  - device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
    domain: cover
    entity_id: 646ddfcbd3a3188708a8c8c6c9b383dd
    type: set_position
    position: 20
  - delay:
      hours: 0
      minutes: 0
      seconds: 10
      milliseconds: 0
  - type: turn_off
    device_id: 9e306f4c2ded510bf2bd63aa7312d89a
    entity_id: switch.madalena_light
    domain: switch
  - delay:
      hours: 0
      minutes: 0
      seconds: 50
      milliseconds: 0
  - device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
    domain: cover
    entity_id: 646ddfcbd3a3188708a8c8c6c9b383dd
    type: set_position
    position: 40
  - delay:
      hours: 0
      minutes: 1
      seconds: 0
      milliseconds: 0
  - device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
    domain: cover
    entity_id: 646ddfcbd3a3188708a8c8c6c9b383dd
    type: set_position
    position: 60
  - delay:
      hours: 0
      minutes: 1
      seconds: 0
      milliseconds: 0
  - device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
    domain: cover
    entity_id: cover.shellyswitch25_c45bbe5fbbe6
    type: open
  mode: single
- id: '1684510209693'
  alias: Ligar indicador de aquecimento
  description: 'Esta automação controla: ligar indicador de aquecimento.'
  trigger:
  - platform: device
    type: turned_on
    device_id: f6496fb848e55b0eeeb40b780a6a7ad3
    entity_id: switch.baxi
    domain: switch
  condition: []
  action:
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.caldeira_ligada
  mode: single
- id: '1684510263654'
  alias: Desligar indicador de caldeira ligada
  description: 'Esta automação controla: desligar indicador de caldeira ligada.'
  trigger:
  - platform: device
    type: turned_off
    device_id: f6496fb848e55b0eeeb40b780a6a7ad3
    entity_id: switch.baxi
    domain: switch
  condition: []
  action:
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.caldeira_ligada
  mode: single
- id: '1684510907095'
  alias: Notificação após alterações no estado da caldeiras
  description: 'Esta automação controla: notificação após alterações no estado da
    caldeiras.'
  triggers:
  - entity_id:
    - switch.baxi
    to: 'off'
    from: 'on'
    trigger: state
  - entity_id:
    - switch.baxi
    to: 'on'
    from: 'off'
    trigger: state
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: device
        type: is_off
        device_id: f6496fb848e55b0eeeb40b780a6a7ad3
        entity_id: switch.baxi
        domain: switch
      sequence:
      - data:
          title: Baxi desligada
          message: A caldeira de aquecimento foi desligada.
        action: notify.mobile_app_onenotenord4
    - conditions:
      - condition: device
        type: is_on
        device_id: f6496fb848e55b0eeeb40b780a6a7ad3
        entity_id: switch.baxi
        domain: switch
      sequence:
      - data:
          title: Baxi ligada
          message: A caldeira de aquecimento foi ligada.
        action: notify.mobile_app_onenotenord4
  mode: single
- id: '1684797310071'
  alias: Porta aberta
  description: 'Esta automação controla: porta aberta.'
  triggers:
  - entity_id: binary_sensor.contact_sensor_b0b4_door_open
    to: 'on'
    trigger: state
  conditions: []
  actions:
  - action: script.notify_door_open_progressive
    data: {}
  - wait_for_trigger:
    - entity_id: binary_sensor.contact_sensor_b0b4_door_open
      to: 'off'
      trigger: state
    timeout:
      hours: 0
      minutes: 20
      seconds: 0
      milliseconds: 0
    continue_on_timeout: false
  - condition: state
    entity_id: binary_sensor.contact_sensor_b0b4_door_open
    state: 'off'
  - action: script.door_closed_notification
    data: {}
  mode: single
- id: '1685625587794'
  alias: Porta de casa fechada
  description: 'Esta automação controla: porta de casa fechada.'
  trigger:
  - type: not_opened
    platform: device
    device_id: 421990f9314c17597d7f3789ada40a83
    entity_id: binary_sensor.contact_sensor_b0b4_door_open
    domain: binary_sensor
  condition: []
  action:
  - service: notify.notify
    data:
      message: A porta de casa foi fechada!
      title: Porta de casa
  mode: single
- id: '1689111108752'
  alias: Alarm set
  description: 'Esta automação controla: alarm set.'
  trigger:
  - type: opened
    platform: device
    device_id: 421990f9314c17597d7f3789ada40a83
    entity_id: binary_sensor.contact_sensor_b0b4_door_open
    domain: binary_sensor
    for:
      hours: 0
      minutes: 0
      seconds: 0
  condition:
  - condition: state
    entity_id: alarm_control_panel.alexa_guard_d128e
    state: armed_away
  - condition: not
    conditions:
    - condition: state
      entity_id: person.camila_oliveira
      state: home
    - condition: state
      entity_id: person.tiago_alves
      state: home
    - condition: state
      entity_id: input_boolean.visits_on_disable_light_automation
      state: 'on'
  action:
  - delay:
      hours: 0
      minutes: 0
      seconds: 10
      milliseconds: 0
  - service: media_player.volume_set
    data:
      volume_level: 1
    target:
      entity_id:
      - media_player.bedroom_echo
      - media_player.kitchen_s_echo
      - media_player.echo_dot_de_tiago
      - media_player.madalena_s_echo
  - service: media_player.play_media
    data:
      media_content_type: sound
      media_content_id: amzn_sfx_scifi_alarm_04
    target:
      device_id:
      - b2a15ab03d14186eaefc6566fc16a85d
      - 094a7c229ede5382aea4bc36c8cfbf1a
      - 8a2159a22682b5e04878bed0a50f0172
      - d3d1694daff64b5ce388813a12db2275
  - service: notify.alexa_media_kitchen_s_echo
    data:
      message: Suspect movements detected. Calling Police!... Calling Police... Calling
        Police... Calling Police. ...
  - service: media_player.play_media
    data:
      media_content_type: sound
      media_content_id: amzn_sfx_scifi_alarm_04
    target:
      device_id:
      - b2a15ab03d14186eaefc6566fc16a85d
      - 094a7c229ede5382aea4bc36c8cfbf1a
      - 8a2159a22682b5e04878bed0a50f0172
      - d3d1694daff64b5ce388813a12db2275
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - service: media_player.volume_set
    data:
      volume_level: 0.3
    target:
      device_id:
      - b2a15ab03d14186eaefc6566fc16a85d
      - 094a7c229ede5382aea4bc36c8cfbf1a
      - 8a2159a22682b5e04878bed0a50f0172
      - d3d1694daff64b5ce388813a12db2275
  - service: notify.mobile_app_mi_9t
    data:
      message: Um intruso foi detectado!
      title: Alarme disparado
  - service: notify.mobile_app_redmi
    data:
      message: Um intruso foi detectado!
      title: Alarme disparado
  mode: single
- id: '1689791001428'
  alias: Ligar carro
  description: 'Esta automação controla: ligar carro.'
  triggers:
  - value_template: "{{ 'F4:4E:FD:7A:9F:74 (BW-BC2)' in state_attr('sensor.onenotenord4_bluetooth_connection','connected_paired_devices')\
      \ \nand \n-65 > states('sensor.onenotenord4_wi_fi_signal_strength') | int\n\
      }}"
    enabled: true
    trigger: template
  - value_template: "{{ 'F4:4E:FD:7A:9F:74 (BW-BC2)' in state_attr('sensor.iphone_bssid','connected_paired_devices')\
      \ \nand \n-65 > states('sensor.iphone_ssid_strenght') | int\n}}"
    trigger: template
    enabled: false
  - value_template: "{{ '41:42:88:00:02:42 (CAR-XTD-BT_F71E)' in state_attr('sensor.onenotenord4_bluetooth_connection','connected_paired_devices')\
      \ \nand \n-65 > states('sensor.onenotenord4_wi_fi_signal_strength') | int\n\
      }}"
    trigger: template
  - value_template: "{{ '41:42:88:00:02:42 (CAR-XTD-BT_F71E)' in state_attr('sensor.iphone_ssid','connected_paired_devices')\
      \ \nand \n-65 > states('sensor.iphone_connection_type_wireless') | int\n}}"
    trigger: template
    enabled: false
  conditions:
  - condition: or
    conditions:
    - condition: state
      entity_id: sensor.onenotenord4_wi_fi_connection
      state: Buraquinho de Marmelada
    - condition: state
      entity_id: sensor.iphone_ssid
      state: Buraquinho de Marmelada
    enabled: true
  actions:
  - target:
      entity_id: scene.porta_da_garagem_subir
    metadata: {}
    action: scene.turn_on
    data: {}
  - action: notify.mobile_app_onenotenord4
    data:
      message: 'Porta exterior aberta! '
  mode: single
- id: '1690465629323'
  alias: Ligar visitas para limpeza
  description: 'Esta automação controla: ligar visitas para limpeza.'
  triggers:
  - entity_id:
    - binary_sensor.contact_sensor_b0b4_door_open
    from: 'off'
    to: 'on'
    trigger: state
  conditions:
  - condition: time
    after: '12:00:00'
    before: '18:00:00'
    weekday:
    - thu
  - condition: not
    conditions:
    - condition: state
      entity_id: input_boolean.visits_on_disable_light_automation
      state: 'on'
    - condition: state
      entity_id: person.camila_oliveira
      state: home
    - condition: state
      entity_id: person.tiago_alves
      state: home
  actions:
  - data: {}
    target:
      entity_id: input_boolean.visits_on_disable_light_automation
    action: input_boolean.turn_on
  mode: single
- id: '1690465798262'
  alias: Desligar visitas casa às quintas
  description: 'Esta automação controla: desligar visitas casa às quintas.'
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.contact_sensor_b0b4_door_open
    from: 'off'
    to: 'on'
  condition:
  - condition: time
    after: '18:00:00'
    weekday:
    - thu
  - condition: not
    conditions:
    - condition: state
      entity_id: input_boolean.visits_on_disable_light_automation
      state: 'off'
  - condition: or
    conditions:
    - condition: state
      entity_id: person.camila_oliveira
      state: Casa
    - condition: state
      state: home
      entity_id: person.tiago_alves
    - condition: state
      entity_id: person.camila_oliveira
      state: home
    - condition: state
      state: Casa
      entity_id: person.tiago_alves
  action:
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.visits_on_disable_light_automation
  mode: single
- id: '1695848384583'
  alias: Desativar aquecimento quando as janelas estão abertas
  description: 'Esta automação controla: desativar aquecimento quando as janelas estão
    abertas.'
  use_blueprint:
    path: raffy-ops/hvac_pause.yaml
    input:
      climate_device: switch.baxi
      doors_windows: binary_sensor.janelas_casa
      pause_action:
      - service: notify.notify
        data:
          message: The heating system was disabled.
          title: Windows are open!
      resume_action:
      - service: notify.notify
        data:
          message: The heating system was resumed.
          title: Windows are now closed again!
  mode: single
- id: '1709587310110'
  alias: Reiniciar ha
  description: 'Esta automação controla: reiniciar ha.'
  trigger:
  - platform: time
    at: 03:00:00
  condition: []
  action:
  - service: hassio.host_reboot
    data: {}
  mode: single
- id: '1710792555923'
  alias: Ligar router de manhã
  description: 'Esta automação controla: ligar router de manhã.'
  trigger:
  - platform: time
    at: 09:05:00
  condition: []
  action:
  - type: turn_on
    device_id: bb1e33d0865073ccbdeb5413b44ae020
    entity_id: dee24664505466a3f7a53b9116b08865
    domain: switch
  mode: single
- id: '1712866520747'
  alias: A etiqueta sala é lida
  description: 'Esta automação controla: a etiqueta sala é lida.'
  triggers:
  - tag_id: 128588f6-4e62-43a6-b2c9-4ef6a7708069
    trigger: tag
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: device
        device_id: 4284d6153210243e2991fd76018ababc
        domain: cover
        entity_id: 91188817a7ef1c3e6a0f41855b9792f3
        type: is_position
        below: 10
      sequence:
      - device_id: 4284d6153210243e2991fd76018ababc
        domain: cover
        entity_id: 91188817a7ef1c3e6a0f41855b9792f3
        type: set_position
        position: 69
      - device_id: c44fa21082233a06cf61d554ee67c0ed
        domain: cover
        entity_id: 63a395517b2d945b32e43907016829e1
        type: open
    - conditions:
      - condition: device
        device_id: 4284d6153210243e2991fd76018ababc
        domain: cover
        entity_id: 91188817a7ef1c3e6a0f41855b9792f3
        type: is_position
        above: 67
      sequence:
      - device_id: 4284d6153210243e2991fd76018ababc
        domain: cover
        entity_id: 91188817a7ef1c3e6a0f41855b9792f3
        type: close
  - wait_for_trigger:
    - tag_id: 128588f6-4e62-43a6-b2c9-4ef6a7708069
      trigger: tag
    timeout:
      hours: 0
      minutes: 0
      seconds: 10
      milliseconds: 0
    continue_on_timeout: false
  - data:
      volume_level: 0.6
    target:
      entity_id:
      - media_player.bedroom_echo
      - media_player.kitchen_s_echo
    action: media_player.volume_set
  - choose:
    - conditions:
      - condition: device
        device_id: ec728d068b8f508a74a7e4bfbf9a2473
        domain: cover
        entity_id: 7c72e81f62bdd332bb8f2b0fb2ab36f5
        type: is_position
        below: 28
      - condition: device
        device_id: 374b68d1a6f679a25009527524c7d6dc
        domain: cover
        entity_id: ce0f1c29d42833b82e7126a12644a223
        type: is_position
        below: 24
      sequence:
      - action: notify.alexa_media_kitchen_s_echo
        metadata: {}
        data:
          message: Bright mode activated. Opening all curtains and windows! It will
            be brighter now! If the reason is for cleaning, happy cleaning though!
      - device_id: c44fa21082233a06cf61d554ee67c0ed
        domain: cover
        entity_id: 63a395517b2d945b32e43907016829e1
        type: open
      - device_id: 4284d6153210243e2991fd76018ababc
        domain: cover
        entity_id: 91188817a7ef1c3e6a0f41855b9792f3
        type: set_position
        position: 69
      - device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
        domain: cover
        entity_id: 646ddfcbd3a3188708a8c8c6c9b383dd
        type: open
      - device_id: ec728d068b8f508a74a7e4bfbf9a2473
        domain: cover
        entity_id: 7c72e81f62bdd332bb8f2b0fb2ab36f5
        type: open
      - device_id: 5c1e4ccb3754b0dbe99b65a69e77325b
        domain: cover
        entity_id: 09fd91dd262c372506de662ecddf7bb9
        type: open
      - device_id: 374b68d1a6f679a25009527524c7d6dc
        domain: cover
        entity_id: ce0f1c29d42833b82e7126a12644a223
        type: open
    - conditions:
      - condition: device
        device_id: ec728d068b8f508a74a7e4bfbf9a2473
        domain: cover
        entity_id: 7c72e81f62bdd332bb8f2b0fb2ab36f5
        type: is_position
        above: 68
      - condition: device
        device_id: 374b68d1a6f679a25009527524c7d6dc
        domain: cover
        entity_id: ce0f1c29d42833b82e7126a12644a223
        type: is_position
        above: 68
      sequence:
      - action: notify.alexa_media_kitchen_s_echo
        metadata: {}
        data:
          message: Hello! All curtains are now closing. Thank you.
      - device_id: 4284d6153210243e2991fd76018ababc
        domain: cover
        entity_id: 91188817a7ef1c3e6a0f41855b9792f3
        type: close
      - device_id: ec728d068b8f508a74a7e4bfbf9a2473
        domain: cover
        entity_id: 7c72e81f62bdd332bb8f2b0fb2ab36f5
        type: close
      - device_id: 374b68d1a6f679a25009527524c7d6dc
        domain: cover
        entity_id: ce0f1c29d42833b82e7126a12644a223
        type: close
  mode: single
- id: '1723930952240'
  alias: Fechar cortina quarto
  description: 'Esta automação controla: fechar cortina quarto.'
  triggers:
  - device_id: 5c1e4ccb3754b0dbe99b65a69e77325b
    domain: cover
    entity_id: 09fd91dd262c372506de662ecddf7bb9
    type: position
    above: 0
    below: 100
    trigger: device
  - type: opened
    device_id: 83ff2d77bf18aca3e7c403e0510887c4
    entity_id: 52001ab749c7d5710a647f6d01930af9
    domain: binary_sensor
    for:
      hours: 0
      minutes: 3
      seconds: 0
    trigger: device
  - type: opened
    device_id: 7fcda03bbccbf57d7d1de658cd60b732
    entity_id: 562a6934b159f47d19b460d6303ff07c
    domain: binary_sensor
    for:
      hours: 0
      minutes: 3
      seconds: 0
    trigger: device
  conditions:
  - condition: device
    device_id: 5c1e4ccb3754b0dbe99b65a69e77325b
    domain: cover
    entity_id: 09fd91dd262c372506de662ecddf7bb9
    type: is_open
  - condition: or
    conditions:
    - type: is_open
      condition: device
      device_id: 7fcda03bbccbf57d7d1de658cd60b732
      entity_id: 562a6934b159f47d19b460d6303ff07c
      domain: binary_sensor
    - type: is_open
      condition: device
      device_id: 83ff2d77bf18aca3e7c403e0510887c4
      entity_id: 52001ab749c7d5710a647f6d01930af9
      domain: binary_sensor
  - condition: device
    device_id: 374b68d1a6f679a25009527524c7d6dc
    domain: cover
    entity_id: ce0f1c29d42833b82e7126a12644a223
    type: is_position
    above: 6
  - type: is_no_motion
    condition: device
    device_id: 83ff2d77bf18aca3e7c403e0510887c4
    entity_id: 3b859b47598ae5433abf6d5133bb330d
    domain: binary_sensor
  actions:
  - device_id: 374b68d1a6f679a25009527524c7d6dc
    domain: cover
    entity_id: ce0f1c29d42833b82e7126a12644a223
    type: close
  mode: single
- id: '1723932605169'
  alias: Fechar cortina quarto da madalena
  description: 'Esta automação controla: fechar cortina quarto da madalena.'
  trigger:
  - platform: device
    device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
    domain: cover
    entity_id: 646ddfcbd3a3188708a8c8c6c9b383dd
    type: position
    above: 0
    below: 100
  - type: opened
    platform: device
    device_id: e33a3e4fbb77fc2f570b1ba19dd3dac1
    entity_id: 9499d8108765fe7e748d3bc7d59113bd
    domain: binary_sensor
    for:
      hours: 0
      minutes: 3
      seconds: 0
  - type: opened
    platform: device
    device_id: 441090baf843eb02f94afd27f4bf568e
    entity_id: 4e8dfaf97e8ddada815ffab0912b4258
    domain: binary_sensor
    for:
      hours: 0
      minutes: 3
      seconds: 0
  condition:
  - condition: device
    device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
    domain: cover
    entity_id: 646ddfcbd3a3188708a8c8c6c9b383dd
    type: is_open
  - condition: or
    conditions:
    - type: is_open
      condition: device
      device_id: 441090baf843eb02f94afd27f4bf568e
      entity_id: 4e8dfaf97e8ddada815ffab0912b4258
      domain: binary_sensor
    - type: is_open
      condition: device
      device_id: e33a3e4fbb77fc2f570b1ba19dd3dac1
      entity_id: 9499d8108765fe7e748d3bc7d59113bd
      domain: binary_sensor
  - condition: device
    device_id: ec728d068b8f508a74a7e4bfbf9a2473
    domain: cover
    entity_id: 7c72e81f62bdd332bb8f2b0fb2ab36f5
    type: is_position
    above: 5
  - type: is_no_motion
    condition: device
    device_id: e33a3e4fbb77fc2f570b1ba19dd3dac1
    entity_id: 82fbd33e340c94510e7f12e25d8e1cfc
    domain: binary_sensor
  action:
  - device_id: ec728d068b8f508a74a7e4bfbf9a2473
    domain: cover
    entity_id: 7c72e81f62bdd332bb8f2b0fb2ab36f5
    type: close
  mode: single
- id: '1724573717674'
  alias: Fechar janela da madalena/quarto pela manhã
  description: 'Esta automação controla: fechar janela da madalena/quarto pela manhã.'
  trigger:
  - platform: sun
    event: sunrise
    offset: 0
  condition:
  - condition: state
    entity_id: sensor.season
    state: summer
  action:
  - device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
    domain: cover
    entity_id: 646ddfcbd3a3188708a8c8c6c9b383dd
    type: close
  - device_id: 5c1e4ccb3754b0dbe99b65a69e77325b
    domain: cover
    entity_id: 09fd91dd262c372506de662ecddf7bb9
    type: close
  mode: single
- id: '1724973750256'
  alias: Desligar máquina de lavar ativar wip
  description: 'Esta automação controla: desligar máquina de lavar ativar wip.'
  triggers:
  - type: power
    device_id: 88f33d586930d31c31fd8d2b4b007528
    entity_id: 692b4f492aa01ab6ec09d1cd4e3b2932
    domain: sensor
    for:
      hours: 0
      minutes: 8
      seconds: 0
    above: 1
    trigger: device
  conditions:
  - condition: state
    entity_id: input_boolean.maquina_de_lavar_working
    state: 'off'
  - condition: state
    entity_id: input_boolean.maquina_de_lavar_starting
    state: 'off'
  actions:
  - action: input_boolean.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.maquina_de_lavar_starting
  mode: single
- id: '1725150539352'
  alias: Alexa reauth required
  description: 'Esta automação controla: alexa reauth required.'
  trigger:
  - platform: event
    event_type: alexa_media_relogin_required
  condition: []
  action:
  - data:
      title: Alexa Media Player Integration
      message: 🔑 Authentication Required
      data:
        actions:
        - action: URI
          title: Resolve now!
          uri: /lovelace/home
    action: notify.mobile_app_mi_9t
  mode: single
- id: '1725578085769'
  alias: Desligar tostadeira
  description: 'Esta automação controla: desligar tostadeira.'
  trigger:
  - platform: device
    type: turned_on
    device_id: f5d732eebb8dbe0756fc868aff033bbf
    entity_id: 24d0a80d5362698384b38828fc620521
    domain: switch
    for:
      hours: 0
      minutes: 5
      seconds: 0
  condition: []
  action:
  - type: turn_off
    device_id: f5d732eebb8dbe0756fc868aff033bbf
    entity_id: 24d0a80d5362698384b38828fc620521
    domain: switch
  mode: single
- id: '1726410298461'
  alias: Indicador de chaleira ligar
  description: 'Esta automação controla: indicador de chaleira ligar.'
  trigger:
  - type: temperature
    platform: device
    device_id: 106d6251964aa89970400e4154a1e8f7
    entity_id: 17d191c152933af9e11bbb8050530d83
    domain: sensor
    above: 60
  condition:
  - condition: state
    entity_id: input_boolean.indicador_da_chaleira_quente
    state: 'off'
  action:
  - action: input_boolean.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.indicador_da_chaleira_quente
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.luz_do_balcao_ligar
  mode: single
- id: '1726434541581'
  alias: Indicador de chaleira desligar
  description: 'Esta automação controla: indicador de chaleira desligar.'
  trigger:
  - type: temperature
    platform: device
    device_id: 106d6251964aa89970400e4154a1e8f7
    entity_id: 17d191c152933af9e11bbb8050530d83
    domain: sensor
    below: 60
  condition:
  - condition: state
    entity_id: input_boolean.indicador_da_chaleira_quente
    state: 'on'
  - condition: state
    entity_id: input_boolean.chaleira_reposta
    state: 'off'
  action:
  - action: input_boolean.turn_off
    target:
      entity_id:
      - input_boolean.indicador_da_chaleira_quente
    data: {}
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.luz_do_balcao_desligar
  mode: single
- id: '1726445448398'
  alias: Desligar indicador máquina de lavar
  description: 'Esta automação controla: desligar indicador máquina de lavar.'
  trigger:
  - platform: state
    entity_id:
    - input_boolean.maquina_de_lavar_com_servico_terminado
    to: 'on'
    for:
      hours: 0
      minutes: 30
      seconds: 0
  condition: []
  action:
  - action: input_boolean.turn_off
    target:
      entity_id:
      - input_boolean.maquina_de_lavar_com_servico_terminado
    data: {}
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.luz_do_balcao_desligar
  mode: single
- id: '1726527224240'
  alias: Desligar máquina da loiça
  description: 'Esta automação controla: desligar máquina da loiça.'
  triggers:
  - type: power
    device_id: 88f33d586930d31c31fd8d2b4b007528
    entity_id: 692b4f492aa01ab6ec09d1cd4e3b2932
    domain: sensor
    below: 250
    for:
      hours: 0
      minutes: 0
      seconds: 0
    above: 80
    trigger: device
  - trigger: state
    entity_id:
    - input_boolean.maquina_de_lavar_working
    to: 'on'
    for:
      hours: 0
      minutes: 40
      seconds: 0
  conditions:
  - condition: state
    entity_id: input_boolean.maquina_de_lavar_working
    state: 'on'
  - condition: state
    entity_id: input_boolean.maquina_de_lavar_starting
    state: 'on'
  - condition: template
    value_template: '{% set last = state_attr(''automation.desligar_maquina_de_lavar'',
      ''last_triggered'') %}

      {{ last is not none and (now() | as_timestamp - last | as_timestamp) < 18000
      }}'
  actions:
  - delay:
      hours: 0
      minutes: 3
      seconds: 0
      milliseconds: 0
  - type: turn_off
    device_id: 88f33d586930d31c31fd8d2b4b007528
    entity_id: 41c18a60078656e939ec2681315e2323
    domain: switch
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - type: turn_on
    device_id: 88f33d586930d31c31fd8d2b4b007528
    entity_id: 41c18a60078656e939ec2681315e2323
    domain: switch
  - action: input_boolean.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.maquina_de_lavar_com_servico_terminado
  - data:
      message: Your dishwasher machine just finished her job! Go check it.
    action: notify.alexa_media_kitchen_s_echo
    enabled: false
  - data:
      message: A máquina de lavar loiça terminou o serviço 🍽️
      title: Máquina de lavar loiça
    action: notify.notify
  - action: script.notify_alexa
    metadata: {}
    data:
      devices:
      - b2a15ab03d14186eaefc6566fc16a85d
      title: Dishwasher machine service complete
      message: Your dishwasher machine just finished her job! Go check it.
      type: announce
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.luz_do_balcao_ligar
  - action: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.maquina_de_lavar_working
  - action: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.maquina_de_lavar_starting
  mode: single
- id: '1726790069744'
  alias: Desligar máquina de lavar a terminar
  description: 'Esta automação controla: desligar máquina de lavar a terminar.'
  triggers:
  - type: power
    device_id: 88f33d586930d31c31fd8d2b4b007528
    entity_id: 692b4f492aa01ab6ec09d1cd4e3b2932
    domain: sensor
    for:
      hours: 0
      minutes: 3
      seconds: 0
    below: 1
    trigger: device
  conditions:
  - condition: state
    entity_id: input_boolean.maquina_de_lavar_working
    state: 'off'
  - condition: state
    entity_id: input_boolean.maquina_de_lavar_starting
    state: 'on'
  actions:
  - action: input_boolean.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.maquina_de_lavar_working
  mode: single
- id: '1729392809438'
  alias: Temperatura alta (ignorar instrução)
  description: 'Esta automação controla: temperatura alta (ignorar instrução).'
  triggers:
  - type: turned_on
    device_id: f6496fb848e55b0eeeb40b780a6a7ad3
    entity_id: efbb52e96303d5f1cb059f78fb5bd6b3
    domain: switch
    trigger: device
  conditions:
  - condition: state
    entity_id: input_boolean.hora_do_banho
    state: 'off'
  - condition: numeric_state
    entity_id: sensor.sensores_de_temperatura_minimo
    above: 19.99
  actions:
  - type: turn_off
    device_id: f6496fb848e55b0eeeb40b780a6a7ad3
    entity_id: efbb52e96303d5f1cb059f78fb5bd6b3
    domain: switch
  - action: notify.notify
    metadata: {}
    data:
      message: Temperatura interior acima de 20°C. Instrução para ligar aquecimento
        ignorada.
      title: 'Instrução para ligar caldeira ignorada '
  mode: single
- id: '1730874270846'
  alias: Rain sound's set on text
  description: 'Esta automação controla: rain sound''s set on text.'
  triggers:
  - trigger: state
    entity_id:
    - input_select.alexa_actions
    to: Rain Sounds
  conditions: []
  actions:
  - action: input_text.set_value
    metadata: {}
    data:
      value: Rain Sounds
    target:
      entity_id: input_text.input_text
  - action: input_number.set_value
    metadata: {}
    data:
      value: 30
    target:
      entity_id: input_number.volume_alexa
  mode: single
- id: '1730874313032'
  alias: Clear input text
  description: 'Esta automação controla: clear input text.'
  triggers:
  - trigger: state
    entity_id:
    - input_select.alexa_actions
    to: Outro
  conditions: []
  actions:
  - action: input_text.set_value
    metadata: {}
    data:
      value: ' '
    target:
      entity_id: input_text.input_text
  - action: input_number.set_value
    metadata: {}
    data:
      value: 30
    target:
      entity_id: input_number.volume_alexa
  mode: single
- id: '1731291077729'
  alias: Reload amazon alexa
  description: 'Esta automação controla: reload amazon alexa.'
  triggers:
  - trigger: state
    entity_id:
    - update.alexa_media_player_update
    to: unavailable
  - trigger: time_pattern
    hours: '1'
    enabled: false
  conditions:
  - condition: sun
    before: sunrise
    after: sunset
  actions:
  - action: homeassistant.reload_config_entry
    data: {}
    target:
      entity_id: media_player.kitchen_s_echo
  - action: notify.mobile_app_mi_9t
    metadata: {}
    data:
      message: Alexa intégration is being reloaded!
      title: 'Alexa Media Player '
  mode: single
- id: '1731310308042'
  alias: Modo noturno (quarto)
  description: 'Esta automação controla: modo noturno (quarto).'
  triggers:
  - trigger: state
    entity_id:
    - input_boolean.luz_noturna_quarto
    to: null
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: input_boolean.luz_noturna_quarto
        state: 'on'
      sequence:
      - action: yeelight.set_mode
        metadata: {}
        data:
          mode: moonlight
        target:
          entity_id: light.yeelight_ceiling20_0x15715f2c
    - conditions:
      - condition: state
        entity_id: input_boolean.luz_noturna_quarto
        state: 'off'
      sequence:
      - action: yeelight.set_mode
        metadata: {}
        data:
          mode: normal
        target:
          entity_id: light.yeelight_ceiling20_0x15715f2c
  mode: single
- id: '1731964967013'
  alias: Controlo da hora do banho desligar
  description: 'Esta automação controla: controlo da hora do banho desligar.'
  triggers:
  - trigger: state
    entity_id:
    - input_boolean.hora_do_banho
    to: 'on'
    for:
      hours: 0
      minutes: 30
      seconds: 0
  conditions: []
  actions:
  - action: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.hora_do_banho
  - condition: numeric_state
    entity_id: sensor.meter_be86_temperature
    above: 22
  - type: turn_off
    device_id: f6496fb848e55b0eeeb40b780a6a7ad3
    entity_id: efbb52e96303d5f1cb059f78fb5bd6b3
    domain: switch
  - action: notify.notify
    metadata: {}
    data:
      title: Hora do banho terminada!
      message: 'Ahhhhhhhh! Cheira bem! Foi do teu banho? '
  mode: single
- id: '1731965802918'
  alias: Controlo da hora do banho ligar
  description: 'Esta automação controla: controlo da hora do banho ligar.'
  triggers:
  - trigger: state
    entity_id:
    - input_boolean.hora_do_banho
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 0
  conditions: []
  actions:
  - type: turn_on
    device_id: f6496fb848e55b0eeeb40b780a6a7ad3
    entity_id: efbb52e96303d5f1cb059f78fb5bd6b3
    domain: switch
  - action: notify.notify
    metadata: {}
    data:
      message: Aproveita que está quentinho agora!
      title: Hora do banho!
  mode: single
- id: '1732994810780'
  alias: Garagem indisponível
  description: 'Esta automação controla: garagem indisponível.'
  triggers:
  - trigger: state
    entity_id:
    - switch.garage_door
    to: unavailable
    for:
      hours: 0
      minutes: 5
      seconds: 0
  - trigger: state
    entity_id:
    - switch.garage_door
    to: unknown
    for:
      hours: 0
      minutes: 5
      seconds: 0
  - trigger: state
    entity_id:
    - switch.garage_door
    to: unavailable
    for:
      hours: 0
      minutes: 10
      seconds: 0
  - trigger: state
    entity_id:
    - switch.garage_door
    to: unknown
    for:
      hours: 0
      minutes: 10
      seconds: 0
  - trigger: state
    entity_id:
    - switch.garage_door
    to: unavailable
    for:
      hours: 1
      minutes: 0
      seconds: 0
  - trigger: state
    entity_id:
    - switch.garage_door
    to: unknown
    for:
      hours: 1
      minutes: 0
      seconds: 0
  conditions:
  - condition: state
    state: 'off'
    entity_id: input_boolean.garagem_desligada_forcada
  actions:
  - action: notify.notify
    metadata: {}
    data:
      message: A reiniciar corrente elétrica na garagem!
      title: 'Garagem indisponível '
  - type: turn_off
    device_id: d8cd66600055fa8c47b222f9f5127666
    entity_id: 7cf815f51bb57dd047fd1211c89f24aa
    domain: switch
  - delay:
      hours: 0
      minutes: 0
      seconds: 10
      milliseconds: 0
  - type: turn_on
    device_id: d8cd66600055fa8c47b222f9f5127666
    entity_id: 7cf815f51bb57dd047fd1211c89f24aa
    domain: switch
  - action: counter.increment
    metadata: {}
    data: {}
    target:
      entity_id: counter.garagem_indisponivel
  mode: single
- id: '1733047117152'
  alias: Luzes de natal ligar
  description: 'Esta automação controla: luzes de natal ligar.'
  triggers:
  - trigger: sun
    event: sunset
    offset: 0
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: switch.luzes_de_natal_tomada_1
      state: unavailable
  actions:
  - type: turn_on
    device_id: c763488096764bdba3cf2a32c173038b
    entity_id: c3ec53cf6b07c244647e08c186c78628
    domain: switch
  - type: turn_on
    device_id: c763488096764bdba3cf2a32c173038b
    entity_id: 0057c5be7205ebf4f665d378c525e587
    domain: switch
  mode: single
- id: '1733047178074'
  alias: Luzes de natal desligar
  description: 'Esta automação controla: luzes de natal desligar.'
  triggers:
  - trigger: time
    at: 00:00:00
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: switch.luzes_de_natal_tomada_1
      state: unavailable
  actions:
  - type: turn_off
    device_id: c763488096764bdba3cf2a32c173038b
    entity_id: c3ec53cf6b07c244647e08c186c78628
    domain: switch
  - type: turn_off
    device_id: c763488096764bdba3cf2a32c173038b
    entity_id: 0057c5be7205ebf4f665d378c525e587
    domain: switch
  mode: single
- id: '1734168054555'
  alias: Desligar som quando timer termina
  description: 'Esta automação controla: desligar som quando timer termina.'
  triggers:
  - trigger: event
    event_type: timer.finished
    event_data:
      entity_id: timer.temporizador
  conditions: []
  actions:
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.stop_sounds_alexa
  - action: timer.cancel
    metadata: {}
    data: {}
    target:
      entity_id: timer.temporizador_auxiliar
  mode: single
- id: '1734180795615'
  alias: Reduzir volume a cada 10 min (ou definido pelo timer)
  description: 'Esta automação controla: reduzir volume a cada 10 min (ou definido
    pelo timer).'
  triggers:
  - event_type: timer.finished
    event_data:
      entity_id: timer.temporizador_auxiliar
    trigger: event
  conditions:
  - condition: state
    entity_id: timer.temporizador
    state: active
  - condition: numeric_state
    entity_id: input_number.volume_alexa
    above: 15
  actions:
  - variables:
      initial_value: '{{ states(''input_number.volume_auxiliar'') | float }}'
      base_value: '{{ states(''input_number.volume_alexa'') | float }}'
      timer_step: '{{ states.timer.temporizador_auxiliar.attributes.duration.split('':'')
        | map(''int'') | sum }}'
      timer_variable: '{{ states.timer.temporizador.attributes.duration.split('':'')
        | map(''int'') | sum }}'
      factor: '{{ timer_step / timer_variable if timer_variable > 0 else 1 }}'
      final_value: '{{ (initial_value - 15 ) * factor }}'
  - action: input_number.set_value
    metadata: {}
    data:
      value: '{{ (max(states(''input_number.volume_alexa'') | int - final_value, 0)
        + 0.99) | int }}

        '
    target:
      entity_id: input_number.volume_alexa
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.alexa_input_set_volume
  - data: {}
    action: timer.start
    target:
      entity_id: timer.temporizador_auxiliar
  mode: single
- id: '1734217482340'
  alias: Frase inspiradora
  description: 'Esta automação controla: frase inspiradora.'
  triggers:
  - trigger: sun
    event: sunrise
    offset: 0
  conditions: []
  actions:
  - variables:
      inspiring_quote: ''
  - action: google_generative_ai_conversation.generate_content
    metadata: {}
    data:
      prompt: 'gera uma frase "bolinho da sorte" inspiradora '
    response_variable: inspiring_quote
  - action: input_text.set_value
    metadata: {}
    data:
      value: '"{{ inspiring_quote.text.strip() }}"

        '
    target:
      entity_id: input_text.inspiring_quote
  mode: single
- id: '1734254917697'
  alias: Set volume inicial para cálculo
  description: 'Esta automação controla: set volume inicial para cálculo.'
  triggers:
  - trigger: state
    entity_id:
    - timer.temporizador
    to: active
  conditions: []
  actions:
  - action: input_number.set_value
    metadata: {}
    data:
      value: '{{states(''input_number.volume_alexa'')}}

        '
    target:
      entity_id: input_number.volume_auxiliar
  mode: single
- id: '1738707285679'
  alias: Fechar porta da garagem (saída de casa)
  description: 'Esta automação controla: fechar porta da garagem (saída de casa).'
  triggers:
  - trigger: zone
    entity_id: person.tiago_alves
    zone: zone.casa_2
    event: leave
  - trigger: zone
    entity_id: person.camila_oliveira
    zone: zone.casa_2
    event: leave
  conditions:
  - condition: template
    value_template: '{{ (now()|as_timestamp - state_attr(''automation.connects_to_buraquinho_de_marmelada'',''last_triggered'')|as_timestamp)
      > 30 }}'
  - type: is_powered
    condition: device
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: binary_sensor.garage_door_external_input
    domain: binary_sensor
  - condition: not
    conditions:
    - condition: state
      entity_id: sensor.onenotenord4_wi_fi_connection
      state: Buraquinho de Marmelada
    - condition: state
      entity_id: sensor.iphone_ssid
      state: Buraquinho de Marmelada
    - condition: state
      entity_id: input_boolean.garagem_aberta_forcar
      state: 'on'
  actions:
  - type: turn_on
    device_id: 5c202b6459996e960257949ef048b3e8
    entity_id: switch.garage_door
    domain: switch
  - delay:
      hours: 0
      minutes: 2
      seconds: 0
      milliseconds: 0
  mode: single
- id: '1739019883657'
  alias: Ligar purificador de ar
  description: 'Esta automação controla: ligar purificador de ar.'
  triggers:
  - type: pm25
    device_id: 06049285d33d5b36d51634d7f09651ea
    entity_id: cc5cc671fc94a42009ae5f781d519d43
    domain: sensor
    trigger: device
    above: 15
  conditions:
  - condition: state
    entity_id: binary_sensor.janelas_casa
    state: 'off'
  actions:
  - type: turn_on
    device_id: 06049285d33d5b36d51634d7f09651ea
    entity_id: db8f011da30b733df0396cc03e8bf1b3
    domain: fan
    enabled: false
  - action: fan.set_preset_mode
    metadata: {}
    data:
      preset_mode: Auto
    target:
      entity_id: fan.zhimi_vb4_f8f8_air_purifier
  - action: notify.notify
    metadata: {}
    data:
      message: Nível de PM2.5 acima de 15 ug/m3 de ar.
      title: Purificador de ar ligado!
  mode: single
- id: '1739020014026'
  alias: Desligar purificador de ar
  description: 'Esta automação controla: desligar purificador de ar.'
  triggers:
  - type: pm25
    device_id: 06049285d33d5b36d51634d7f09651ea
    entity_id: cc5cc671fc94a42009ae5f781d519d43
    domain: sensor
    trigger: device
    below: 3
    for:
      hours: 0
      minutes: 10
      seconds: 0
  - trigger: state
    entity_id:
    - binary_sensor.janelas_casa
    to: 'on'
  - trigger: time
    at: 08:00:00
  conditions:
  - condition: device
    device_id: 06049285d33d5b36d51634d7f09651ea
    domain: fan
    entity_id: db8f011da30b733df0396cc03e8bf1b3
    type: is_on
  - condition: not
    conditions:
    - condition: and
      conditions:
      - condition: state
        entity_id: fan.zhimi_vb4_f8f8_air_purifier
        attribute: preset_mode
        state: Manual
      - condition: time
        after: '22:00:00'
        before: 08:00:00
  actions:
  - type: turn_off
    device_id: 06049285d33d5b36d51634d7f09651ea
    entity_id: db8f011da30b733df0396cc03e8bf1b3
    domain: fan
  - action: notify.notify
    metadata: {}
    data:
      message: Nível de PM2.5 de novo abaixo de 3ug/m3 de ar.
      title: Purificador de ar desligado!
  mode: single
- id: '1749343871219'
  alias: Fechar janelas pela manhã para evitar a luz
  description: 'Esta automação controla: fechar janelas pela manhã para evitar a luz.'
  triggers:
  - at: 03:30:00
    trigger: time
    enabled: false
  - trigger: sun
    event: sunrise
    offset: -00:30:00
  conditions:
  - condition: state
    entity_id: sensor.season
    state: summer
  actions:
  - choose:
    - conditions: []
      sequence:
      - device_id: 5c1e4ccb3754b0dbe99b65a69e77325b
        domain: cover
        entity_id: cover.bedroom_window
        type: set_position
        position: 0
      - device_id: c44fa21082233a06cf61d554ee67c0ed
        domain: cover
        entity_id: 63a395517b2d945b32e43907016829e1
        type: close
      - device_id: 864c6f7d38541b2ca0fa9167f3d21dfc
        domain: cover
        entity_id: cover.shellyswitch25_c45bbe5fbbe6
        type: set_position
        position: 0
      - device_id: 4284d6153210243e2991fd76018ababc
        domain: cover
        entity_id: 91188817a7ef1c3e6a0f41855b9792f3
        type: close
  mode: single
- id: '1749908094785'
  alias: Sem bateria nas cortinas
  description: 'Esta automação controla: sem bateria nas cortinas.'
  triggers:
  - entity_id: sensor.cortina_bateria
    attribute: battery_quantity
    below: 20
    trigger: numeric_state
  - entity_id: sensor.cortina_madalena_bateria
    attribute: battery_quantity
    below: 20
    trigger: numeric_state
  - entity_id: sensor.cortina_quarto_bateria
    attribute: battery_quantity
    below: 20
    trigger: numeric_state
  conditions: []
  actions:
  - variables:
      sensors: "{% set sensores = [\n  'sensor.cortina_bateria',\n  'sensor.cortina_madalena_bateria',\n\
        \  'sensor.cortina_quarto_bateria'\n] %} {% set alerta = [] %} {% for s in\
        \ sensores %}\n  {% set val = state_attr(s, 'battery_quantity') | default(100)\
        \ %}\n  {% if val is number and val < 20 %}\n    {% set nome = s.replace('sensor.cortina_',\
        \ '').replace('_bateria', '').replace('_', ' ').title() %}\n    {% set alerta\
        \ = alerta + [nome ~ ' (' ~ val ~ '%)'] %}\n  {% endif %}\n{% endfor %} {{\
        \ alerta | join(', ') }}\n"
  - data:
      title: 🔋 Bateria baixa nas cortinas
      message: 'As seguintes cortinas estão com bateria fraca: {{ sensors }}'
    action: notify.mobile_app_onenotenord4
  mode: single
- id: '1751828377942'
  alias: Loop ultrasonic sound on alexa for 10h
  description: 'Esta automação controla: loop ultrasonic sound on alexa for 10h.'
  triggers:
  - minutes: /5
    trigger: time_pattern
  conditions:
  - condition: time
    after: '18:00:00'
    before: 08:00:00
    weekday:
    - sun
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
  actions:
  - data:
      media_content_type: music
      media_content_id: https://dl.dropboxusercontent.com/scl/fi/oqwgk7e4uru7o2bv1xnas/ultrasound_repellent_5min.mp3?rlkey=egusy2uyax267lw4dmy74x8wz&st=9g5outwj
    action: media_player.play_media
    target:
      entity_id:
      - media_player.echo_dot_de_tiago
      - media_player.bedroom_echo
      - media_player.madalena_s_echo
  mode: single
- id: '1753394696103'
  alias: Shelly unavailability detection & notification
  description: 'Esta automação controla: shelly unavailability detection & notification.'
  use_blueprint:
    path: TAPAlves/unavailability_entities.yaml
    input:
      actions:
      - action: notify.mobile_app_onenotenord4
        metadata: {}
        data:
          message: A(s) entidade(s) {{ entities }} está indisponível. Valida, por
            favor.
          title: Shelly indisponível
      exclude:
        device_id: 94d1d4eed5aaf134fc6317f6e30aa110
  mode: single
